import{z as $,y as O,r as a,j as e,l as J,aj as G,ak as K,J as X,al as W,am as Z}from"./react-vendor-DsHVXrKi.js";import{L as i,T as C,l as Q,c as ee,i as se}from"./textarea-HuCQAI_-.js";import{B as j}from"./button-S4aBVTK-.js";import{I as u}from"./input-D2xCbKKL.js";import{u as te,L as ae}from"./main-BD73Teme.js";import"./vendor-B5cR7mE1.js";const S=[{type:"virtual",title:"Virtual Consultation",description:"Connect with a dentist via video call without leaving your home",price:599,icon:e.jsx(G,{className:"text-sociodent-600",size:24})},{type:"home",title:"Home Visit",description:"Have a qualified dentist visit your home for consultation",price:1499,icon:e.jsx(K,{className:"text-sociodent-600",size:24})},{type:"clinic",title:"Clinic Consultation",description:"Visit our dental clinic for a comprehensive consultation",price:999,icon:e.jsx(X,{className:"text-sociodent-600",size:24})}],ie="rzp_test_YOUR_KEY_HERE",re=[{id:"razorpay",name:"Card/UPI/Netbanking",icon:e.jsx(W,{className:"h-5 w-5"})},{id:"cash",name:"Cash on Visit",icon:e.jsx(Z,{className:"h-5 w-5"}),disabledFor:["virtual"]}],ue=()=>{const k=$(),R=O(),{toast:r}=te(),z=new URLSearchParams(k.search).get("type")||"virtual",[l,d]=a.useState(1),[n,F]=a.useState(z),[o,T]=a.useState("razorpay"),[D,P]=a.useState(!0),[I,L]=a.useState(!1),[w,y]=a.useState(!1),[g,M]=a.useState(""),[p,q]=a.useState(localStorage.getItem("lastUsedPhone")||""),[m,Y]=a.useState(""),[x,B]=a.useState(""),[f,E]=a.useState(""),[v,A]=a.useState(""),[N,U]=a.useState(!1),[le,H]=a.useState(null),c=S.find(s=>s.type===n);a.useEffect(()=>{(async()=>{try{P(!0);const t=await Q();L(t),t||r({title:"Payment System Error",description:"Failed to load payment system. Please try again later.",variant:"destructive"})}catch(t){console.error("Razorpay initialization error:",t),r({title:"Payment System Error",description:"Failed to initialize payment system. Please try again later.",variant:"destructive"})}finally{P(!1)}})()},[r]);const V=async()=>{var s;if(!I){r({title:"Payment System Not Ready",description:"Please wait for the payment system to initialize or refresh the page.",variant:"destructive"});return}try{y(!0);const t=Math.round(c.price*100),h=await ee(t);await se({key:ie??"",amount:h.amount,currency:"INR",name:"SocioDent",description:`${c.title} Consultation`,order_id:h.id,prefill:{name:g,email:"",contact:p},notes:{consultationType:n,date:m,time:x,address:n!=="virtual"?f:void 0,symptoms:v},theme:{color:"#0284C7"},handler:_=>{console.log("Payment successful:",_),d(3),r({title:"Payment Successful",description:"Your consultation has been booked successfully.",variant:"default"})}})}catch(t){console.error("Payment failed:",t),r({title:"Payment Failed",description:t.message??"There was an error processing your payment. Please try again.",variant:"destructive"}),(s=t.message)!=null&&s.includes("payment")||d(1),y(!1)}},b=()=>{if(l===1){if(!g||!p||!m||!x||n!=="virtual"&&!f||!v){r({title:"Missing Information",description:"Please fill in all required fields",variant:"destructive"});return}if(!N){r({title:"Report Required",description:"Please confirm you have a dental report or upload one",variant:"destructive"});return}localStorage.setItem("lastUsedPhone",p),d(2)}else l===2?o==="razorpay"?V():(d(3),r({title:"Success!",description:"Your appointment has been booked successfully.",variant:"default"})):R("/")};return e.jsx("div",{className:"min-h-screen flex flex-col",children:e.jsx("main",{className:"flex-grow pt-20",children:e.jsx("section",{className:"py-12 bg-gray-50",children:e.jsx("div",{className:"container-custom",children:e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsx("div",{className:"mb-10",children:e.jsx("div",{className:"flex items-center justify-between",children:["Consultation Details","Payment","Confirmation"].map((s,t)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`rounded-full h-10 w-10 flex items-center justify-center ${l>t+1?"bg-green-500 text-white":l===t+1?"bg-sociodent-600 text-white":"bg-gray-200 text-gray-500"}`,children:l>t+1?"✓":t+1}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium",children:s})}),t<2&&e.jsx("div",{className:"hidden sm:block w-24 border-t border-gray-200 mx-4"})]},s))})}),e.jsx("div",{className:"glass-card border border-white/50 rounded-2xl overflow-hidden shadow-md bg-white",children:D?e.jsxs("div",{className:"p-6 text-center",children:[e.jsx(ae,{}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Initializing payment system..."})]}):e.jsxs(e.Fragment,{children:[l===1&&e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Book Your Consultation"}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{className:"text-base font-medium mb-3 block",children:"Select Consultation Type"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:S.map(s=>e.jsxs("div",{className:`border rounded-xl p-4 cursor-pointer transition-all ${n===s.type?"border-sociodent-600 bg-sociodent-50":"border-gray-200 hover:border-sociodent-300"}`,onClick:()=>F(s.type),children:[e.jsxs("div",{className:"flex items-center mb-2",children:[s.icon,e.jsx("span",{className:"ml-2 font-medium",children:s.title})]}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),e.jsxs("p",{className:"mt-2 text-sociodent-600 font-semibold",children:["₹",s.price.toFixed(2)]})]},s.type))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Full Name *"}),e.jsx(u,{id:"name",value:g,onChange:s=>M(s.target.value),placeholder:"John Doe",required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"phone",children:"Phone Number *"}),e.jsx(u,{id:"phone",value:p,onChange:s=>q(s.target.value),placeholder:"+91 12345 67890",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"date",children:"Preferred Date *"}),e.jsx(u,{id:"date",type:"date",value:m,onChange:s=>Y(s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"time",children:"Preferred Time *"}),e.jsx(u,{id:"time",type:"time",value:x,onChange:s=>B(s.target.value),required:!0})]})]}),n!=="virtual"&&e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"address",children:"Address *"}),e.jsx(C,{id:"address",value:f,onChange:s=>E(s.target.value),placeholder:"Your full address",rows:3,required:!0})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Dental Symptoms"}),e.jsxs("div",{className:"mb-4",children:[e.jsx(i,{htmlFor:"symptoms",children:"Describe your symptoms *"}),e.jsx(C,{id:"symptoms",value:v,onChange:s=>A(s.target.value),placeholder:"Describe what dental issues you're experiencing",rows:4,required:!0})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("input",{type:"checkbox",id:"hasReport",checked:N,onChange:s=>U(s.target.checked),className:"mr-2",required:!0}),e.jsx(i,{htmlFor:"hasReport",className:"cursor-pointer",children:"I have a dental report or X-ray (required)"})]}),N&&e.jsxs("div",{className:"mt-2",children:[e.jsx(i,{htmlFor:"reportFile",children:"Upload your dental report or X-ray"}),e.jsx(u,{id:"reportFile",type:"file",onChange:s=>{s.target.files&&s.target.files.length>0&&H(s.target.files[0])},accept:".pdf,.jpg,.jpeg,.png"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Accepted formats: PDF, JPG, PNG (Max size: 5MB)"})]})]})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-sociodent-600",children:["₹",c.price.toFixed(2)]})]}),e.jsxs(j,{className:"w-full",onClick:b,children:["Continue to Payment ",e.jsx(J,{className:"ml-1 h-4 w-4"})]})]})]}),l===2&&e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Payment Method"}),e.jsxs("div",{className:"mb-6",children:[e.jsx(i,{className:"text-base font-medium mb-3 block",children:"Select Payment Method"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:re.map(s=>{var h;const t=(h=s.disabledFor)==null?void 0:h.includes(n);return e.jsxs("div",{className:`
                                    border rounded-lg p-4 flex items-center cursor-pointer transition-all
                                    ${t?"opacity-50 cursor-not-allowed":""}
                                    ${o===s.id&&!t?"border-sociodent-600 bg-sociodent-50":"border-gray-200 hover:border-sociodent-300"}
                                  `,onClick:()=>!t&&T(s.id),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`w-5 h-5 rounded-full border flex items-center justify-center mr-3 ${o===s.id&&!t?"border-sociodent-600":"border-gray-300"}`,children:o===s.id&&!t&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-sociodent-600"})}),s.icon,e.jsx("span",{className:"ml-2 font-medium",children:s.name})]}),t&&e.jsxs("span",{className:"ml-auto text-sm text-gray-500",children:["Not available for ",n," consultation"]})]},s.id)})})]}),o==="cash"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Cash Payment"}),e.jsx("p",{className:"text-gray-600",children:"You will need to pay the amount in cash during the consultation. Our dentist will provide a receipt for your payment."})]}),e.jsxs("div",{className:"border-t pt-6 mt-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Booking Summary"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Consultation Type:"}),e.jsx("span",{className:"font-medium",children:c.title})]}),e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Date & Time:"}),e.jsxs("span",{className:"font-medium",children:[m," at ",x]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total:"}),e.jsxs("span",{className:"font-bold text-sociodent-600",children:["₹",c.price.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(j,{variant:"outline",onClick:()=>d(1),children:"Back"}),e.jsx(j,{className:"flex-1",onClick:b,disabled:w,children:w?"Processing...":"Complete Payment"})]})]})]}),l===3&&e.jsxs("div",{className:"p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Booking Confirmed!"}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Your ",n," consultation has been successfully booked."]}),e.jsxs("div",{className:"max-w-md mx-auto bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Appointment Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-y-2 text-sm",children:[e.jsx("div",{className:"text-gray-600",children:"Consultation:"}),e.jsx("div",{className:"font-medium",children:c.title}),e.jsx("div",{className:"text-gray-600",children:"Date:"}),e.jsx("div",{className:"font-medium",children:m}),e.jsx("div",{className:"text-gray-600",children:"Time:"}),e.jsx("div",{className:"font-medium",children:x}),e.jsx("div",{className:"text-gray-600",children:"Payment Method:"}),e.jsxs("div",{className:"font-medium",children:[o==="razorpay"&&"Card/UPI/Netbanking",o==="cash"&&"Cash on Visit"]}),e.jsx("div",{className:"text-gray-600",children:"Amount Paid:"}),e.jsxs("div",{className:"font-medium text-sociodent-600",children:["₹",c.price.toFixed(2)]})]})]}),e.jsx(j,{onClick:b,children:"Return to Home"})]})]})})]})})})})})};export{ue as default};
